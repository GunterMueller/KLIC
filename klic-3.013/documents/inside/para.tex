% (C) 1998 Japan Information Processing Development Center
% 詳細な配布条件については、COPYRIGHT-JIPDEC.jを参照してください。

\chapter{概要}

本章では、メッセージ通信版、共有データ通信版双方について概要を述べる。

\section{両版の違い}

メッセージ通信版、共有データ通信版の最大の違いは、
「ノード間で物理的にデータを共有しているかどうか」である。
メッセージ通信版では、すべてのメモリ空間はノード毎に分割されており、
データの共有はない。一方、共有データ通信版では、全てのノードで共有しているような
メモリ空間が存在し、そこに置かれたKL1データをノード間で読み書きすることにより
ノード間通信を行う(KLICの共有データ通信版では、ノード間で共有されないような
メモリ空間も存在し、そこに置かれたデータは、単一のノードでのみ利用可能となる)。

\section{ノードの表現}

共有メモリ版では、ノードは、UNIXのプロセスとして実装される。
メッセージ通信版では、PVMを利用する場合にはノードはPVMのタスクとして実装され、
PVMを利用しない場合にはUNIXのプロセスとして実装される。

\section{逐次版とのインターフェース}

並列版は、原則、「ノード間の参照」を表わす参照セルをジェネリックオブジェクトにより
導入することにより実現されている。「参照」は基本的には
KL1レベルでは未定義変数、または、透過的に見えるべき参照セルである。

\begin{description}
\item[メッセージ通信版:\ ] 基本的に、外部への参照を表現する
セルをgenerator、外部から参照されているセル、または、
外部へ参照をしているが、すでにdereferenceを開始しているセル
をconsumerにより表現している。

これらへのunify, derefenceなどのkernelからの操作をこれらの
objectがメッセージ通信に翻訳することにより分散処理が行われる。

\item[共有メモリ通信版:\ ] 基本的に、共有メモリ中に置かれる
変数セルはgeneratorとして実装される。
\end{description}

基本的には(まさに通信されている間を除くと)、他のデータ構造については
逐次処理系と全く同じものを用い、それに対しての処理も基本的に同じものとする。

\section{両者の切りわけ}

各々の切り分けはソースコード上は以下のようになっている。

\begin{description}
\item[メッセージ通信版でのみ必要なファイル群:\ ]
\filename{dist\*.c}, \filename{lock.s}, 
\filename{config}ディレクトリ以下。

\item[共有メモリ版でのみ必要なファイル群:\ ]
\filename{shm\_*.c}.

\item[その他、(逐次版とも)共用されているファイル群:\ ]
内部にて、マクロで切りかえられている。

\begin{description}
\item[DIST:\ ] メッセージ通信版としてコンパイルするときのマクロ。

\item[SHM:\ ] 共有メモリ版としてコンパイルするときのマクロ。
\end{description}
\end{description}






